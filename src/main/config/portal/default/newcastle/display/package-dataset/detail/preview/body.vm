#macro(sectionHeading $heading)
<span class="accordion-header">$heading</span>
#end
#macro(display $key $name)
    <tr>
        <th>$name</th>
        <td>#displayValue($key)</td>
    </tr>
#end
#macro(displayList $key $name)
    <tr>
        <th>$name</th>
        <td>#displayValueList($key)</td>
    </tr>
#end
#macro(displayValue $key)
    #set($value = $metaMap.get($key))
    #if($value.size())
        #foreach($item in $value)
            <span class="meta-value">$!page.escapeHtml($item)</span><br/>
        #end
    #else
        $!page.escapeHtml($value)
    #end
#end
#macro(displayValueList $prefix)
    #set($prefixList = $self.getList($prefix))
    #foreach($key in $prefixList.keySet())
        #foreach($value in $prefixList.get($key))
            <span class="meta-value">$!page.escapeHtml($value)</span><br/>
        #end
    #end
#end
<p><a href="#" id="toggle-accordion">Show all sections</a></p>
<div class="accordion">
    #parseDisplayTemplate("detail/preview/sections/general.vm")
    #parseDisplayTemplate("detail/preview/sections/description.vm")
    #parseDisplayTemplate("detail/preview/sections/people.vm")
    #parseDisplayTemplate("detail/preview/sections/subject.vm")
    #parseDisplayTemplate("detail/preview/sections/provenance.vm")
    #parseDisplayTemplate("detail/preview/sections/management.vm")
    #parseDisplayTemplate("detail/preview/sections/admin.vm")
</div>
<script type="text/javascript">
$(function(){
    function addAccordion() {
        $(".accordion").accordion({
            active:1,
            autoHeight:false,
            clearStyle:true,
            collapsible:false,
            header:".accordion-header"
        });
    }
    $("#toggle-accordion").click(function(){
        if ($(".ui-accordion").length > 0) {
            $(".accordion").accordion("destroy");
            $(this).text("Show sections individually");
        } else {
            addAccordion();
        }
        return false;
    });
    addAccordion();
});
</script>
