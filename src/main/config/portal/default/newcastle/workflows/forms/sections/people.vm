<div class="nameLookup-section">
    <input type="hidden" class="nameLookup-url" value="../proxyGet?ns=Parties_People&qs=searchTerms%3D{searchTerms}" />
    <input type="hidden" class="nameLookup-value-ns" value="nl" />

    <h2>
        Creators <span class="required" title="required">(*)</span>
        <span class="helpWidget" data-help-content-id="help-creators">
            <img src="../images/icons/help.png"/>
        </span>
    </h2>
    <div class="help-content" id="help-creators">
        <p>Record names of the creators.</p>
        <ul>
            <li>
                Enter the given name or family name of persons who created the
                research dataset/collection, registry/repository, catalogue or
                index. Click 'lookup' to search and select the name authority
                record.
            </li>
            <li>Select the persons' appropriate affiliation.</li>
            <li>
                Indicate persons with roles of 'Chief Investigator' or 'Partner
                Investigator' by checking the boxes provided.
            </li>
        </ul>
    </div>
    <table class="input-list sortable">
        <thead>
            <tr class="header-row">
                <th>&nbsp;</th>
                <th>CI</th>
                <th colspan="4">PI</th>
            </tr>
        </thead>
        <tfoot>
            <tr>
                <td colspan="3">&nbsp;</td>
                <td colspan="6">
                    <input class="add-another-item" type="button" value="Add person" />
                </td>
            </tr>
        </tfoot>
        <tbody>
            <tr class="item-input-display sortable-item">
                <td style="vertical-align:middle;">
                    <img class="facets-grip" src="../images/icons/grippy.png" />
                </td>
                <td style="vertical-align:middle;">
                    <input type="checkbox" name="scope" value="1"
                           id="dc:creator.foaf:Person.0.ci" />
                </td>
                <td style="vertical-align:middle;">
                    <input type="checkbox" name="scope" value="1"
                           id="dc:creator.foaf:Person.0.pi" />
                </td>
                <td>
                    <table>
                        <tbody>
                            <tr>
                                <td style="border-bottom:none;">
                                    <label for="dc:creator.foaf:Person.0.foaf:givenName">Given name:</label>
                                    <input type="text" placeholder="given name" size="30"
                                           class="nameLookup-name creatorGivenName creatorName"
                                           id="dc:creator.foaf:Person.0.foaf:givenName" />
                                    <label for="dc:creator.foaf:Person.0.foaf:familyName">Family name:</label>
                                    <input type="text" placeholder="family name" size="30"
                                           class="nameLookup-name creatorFamilyName creatorName"
                                           id="dc:creator.foaf:Person.0.foaf:familyName" />
                                    <span style="white-space:nowrap;">
                                        <a href="#" class="nameLookup-lookup" data-selected-func="lookupDone">lookup</a>
                                        <span class="identified-as-name" style="border:0px solid #aaaaaa;padding:0.25ex;"></span>
                                        <input id="dc:creator.foaf:Person.0.dc:title"
                                               type="hidden"
                                               class="nl nl-rdfs:label" readonly="readonly"/>
                                        <input type="hidden" id="dc:creator.foaf:Person.0.dc:identifier"
                                               class="nl nl-rdf:about" value="" />
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td style="border:none">
                                    <label class="validation-err-msg"
                                        for="dc:creator.foaf:Person.0.foaf:givenName"
                                        data-validation-rule="test(notEmpty);when(onChange, onBlur, onSubmit);
                                                                jsTest(
                                                                    var fid, gid, f, g;
                                                                    fid=id.replace('given', 'family');
                                                                    gid=id.replace('family', 'given');
                                                                    f=ctx.find('input[id='+fid+']').val();
                                                                    g=ctx.find('input[id='+gid+']').val();
                                                                    f=jQ.trim(f); g=jQ.trim(g);
                                                                    r=(g=='')&&(f=='');
                                                                    id=gid;
                                                                );
                                                                liveFor(.creatorName);">
                                        A creators given name or family name is required!
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    Affiliation:
                                    <span class="data-source-drop-down"
                                          data-delay="1"
                                          data-json-source-url="../proxyGet?ns=Parties_Groups&qs=count%3D9999"
                                          data-id-key="rdf:about"
                                          data-label-key="rdfs:label"
                                          data-list-key="results">
                                        <span class="selection-added">
                                            <input type="hidden" class="selection-added-id"
                                                   id="dc:creator.foaf:Person.0.association" value="" />
                                            <input type="text" class="selection-added-label" readonly="readonly" size="60"
                                                   id="dc:creator.foaf:Person.0.association.skos:prefLabel" value="" />
                                            <a href="#" class="clear-item">change</a>
                                        </span>
                                        <span class="drop-down-location">
                                            <button class="selection-add add-unique-only" data-add-on-click="1">
                                                Select
                                            </button>
                                        </span>
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td style="vertical-align:middle;" class="delete-item"><a href="#">delete</a></td>
            </tr>
        </tbody>
    </table>

    <h2>
        Primary contact
        <span class="helpWidget" data-help-content-id="help-primary-contact">
            <img src="../images/icons/help.png"/>
        </span>
    </h2>
    <div class="help-content" id="help-primary-contact">
        Record the details of person nominated as 'primary contact' for the
        research dataset/collection, registry/repository, catalogue or index.
        Enter a given or family name or given name and click 'lookup'.
    </div>
    <table>
        <tr>
            <td>
                <label for="primary_contact_name">Name</label>
                <input type="text" size="60" placeholder="full name" id="primary_contact_name" />
            </td>
        </tr>
        </tr>
            <td>
                <label for="primary_contact_email">Email</label>
                <input type="text" size="60" placeholder="email address" id="primary_contact_email" />
            </td>
        </tr>
    </table>

    <h2>
        <label for="supervisor">Supervisor</label>
        <span class="helpWidget" data-help-content-id="help-supervisor">
            <img src="../images/icons/help.png"/>
        </span>
    </h2>
    <div class="help-content" id="help-supervisor">
        Record name of supervisor associated with the data creation if
        applicable. Enter family name or given name to search and select the
        name authority record.
    </div>
    <input type="text" size="60" placeholder="supervisor full name" id="supervisor" />

    <p>
        <h2>
            <label for="collaborators">Collaborators</label>
            <span class="helpWidget" data-help-content-id="help-collaborators">
                <img src="../images/icons/help.png"/>
            </span>
        </h2>
        <div class="help-content" id="help-collaborators">
            Names of other collaborators in the research project, if applicable,
            e.g. CSIRO, University of X, Prof. Jim Bloggs, etc.
        </div>
        <table class="input-list">
            <tfoot>
                <tr>
                    <td></td>
                    <td><input type="button" class="add-another-item" value="Add collaborator" /></td>
                    <td></td>
                    <td></td>
                </tr>
            </tfoot>
            <tbody>
                <tr class="item-input-display sortable-item">
                    <td class="sort-number"></td>
                    <td><input type="text" size="60" placeholder="collaborator" id="collaborators.0" /></td>
                    <td class="delete-item"><a href="#">delete</a></td>
                    <td style="width: 100%;" />
                </tr>
            </tbody>
        </table>
    </p>
</div>
<script type="text/javascript">
function lookupDone(target, resultJson){
    var p=target.parent();
    target.text("identified as:");
    p.find(".identified-as-name").text(p.find("input.nl").val());
}
</script>
